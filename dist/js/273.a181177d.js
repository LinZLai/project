"use strict";(self["webpackChunksystem_vue"]=self["webpackChunksystem_vue"]||[]).push([[273],{3273:function(e,t,r){r.r(t),r.d(t,{default:function(){return n}});var l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"advertsing"},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"主题",prop:"theme"}},[r("el-input",{model:{value:e.ruleForm.theme,callback:function(t){e.$set(e.ruleForm,"theme",t)},expression:"ruleForm.theme"}})],1),r("el-form-item",{attrs:{label:"截止时间",required:""}},[r("el-col",{attrs:{span:11}},[r("el-form-item",{attrs:{prop:"date1"}},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期"},model:{value:e.ruleForm.date1,callback:function(t){e.$set(e.ruleForm,"date1",t)},expression:"ruleForm.date1"}})],1)],1),r("el-col",{staticClass:"line",attrs:{span:2}},[e._v("-")]),r("el-col",{attrs:{span:11}},[r("el-form-item",{attrs:{prop:"date2"}},[r("el-time-picker",{staticStyle:{width:"100%"},attrs:{placeholder:"选择时间"},on:{blur:e.timeChange},model:{value:e.ruleForm.date2,callback:function(t){e.$set(e.ruleForm,"date2",t)},expression:"ruleForm.date2"}})],1)],1)],1),r("el-form-item",{attrs:{label:"广告描述",prop:"content"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.content,callback:function(t){e.$set(e.ruleForm,"content",t)},expression:"ruleForm.content"}})],1),r("el-form-item",{staticStyle:{"max-height":"100px"},attrs:{label:"广告图片",prop:"ADimg"}},[r("el-upload",{ref:"MyUpload",staticStyle:{height:"100px"},attrs:{action:"http://localhost:8081/img","list-type":"picture-card","auto-upload":!1,limit:1,data:{id:this.flag},title:"仅允许上传一张图片"},scopedSlots:e._u([{key:"file",fn:function(t){var l=t.file;return r("div",{},[r("img",{staticClass:"el-upload-list__item-thumbnail",staticStyle:{height:"100px"},attrs:{src:l.url,alt:""}}),r("span",{staticClass:"el-upload-list__item-actions"},[r("span",{staticClass:"el-upload-list__item-status-text"},[r("i",{staticClass:"el-icon-download"})]),e.disabled?e._e():r("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleRemove(l)}}},[r("i",{staticClass:"el-icon-delete"})])])])}}])},[r("i",{staticClass:"el-icon-plus",staticStyle:{height:"100px"},attrs:{slot:"default"},slot:"default"})]),r("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),r("el-form-item",{attrs:{label:"价格",prop:"price"}},[r("el-input",{staticStyle:{width:"50%",color:"#ffce45","margin-left":"-190px"},attrs:{disabled:""},model:{value:e.price,callback:function(t){e.price=t},expression:"price"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("立即创建")]),r("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1)},a=[],s={name:"Advertising",data(){return{userForm:this.$store.getters.getUser,ruleForm:{ownerID:this.$store.getters.getUser.id},dialogImageUrl:"",dialogVisible:!1,disabled:!1,price:0,rules:{theme:[{required:!0,message:"请输入广告主题",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}],date1:[{type:"date",required:!0,message:"请选择日期",trigger:"change"}],date2:[{type:"date",required:!0,message:"请选择时间",trigger:"change"}],content:[{required:!0,message:"请填写广告描述",trigger:"blur"}]},flag:""}},mounted(){},methods:{submitForm(e){this.$refs[e].validate((e=>{if(!e)return console.log("error submit!!"),!1;var t=this.$moment(this.ruleForm.date1).format("YYYY-MM-DD"),r=this.$moment(this.ruleForm.date2).format("HH:mm:ss");this.ruleForm.date=t+" "+r,this.ruleForm.price=this.price,this.$axios.post("/advertising",this.ruleForm).then((e=>{200==e.data.code?(this.$message.success("申请成功"),this.flag=e.data.data.id,this.$refs["MyUpload"].submit(),this.resetForm("ruleForm")):this.$message.error(e.data.msg)}))}))},resetForm(e){this.$refs[e].resetFields(),this.$refs["MyUpload"].clearFiles()},handleRemove(e){this.$refs["MyUpload"].clearFiles()},timeChange(){var e=this.$moment(this.ruleForm.date1).format("YYYY-MM-DD"),t=this.DateDiffer(e);this.price=100*t},DateDiffer(e){let t=new Date(e),r=new Date;t=new Date(t.getFullYear(),t.getMonth(),t.getDate()),r=new Date(r.getFullYear(),r.getMonth(),r.getDate());const l=t.getTime()-r.getTime(),a=l/864e5;return a}}},i=s,o=r(1001),m=(0,o.Z)(i,l,a,!1,null,"39b02ef7",null),n=m.exports}}]);
//# sourceMappingURL=273.a181177d.js.map